(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{215:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("原文地址："),a("a",{attrs:{href:"https://blog.csdn.net/GGxiaobai/article/details/53504989",target:"_blank",rel:"noopener noreferrer"}},[s._v("CentOS 7中添加一个新用户并授权"),a("OutboundLink")],1)]),s._v(" "),a("h1",{attrs:{id:"centos-7添加用户并授权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#centos-7添加用户并授权","aria-hidden":"true"}},[s._v("#")]),s._v(" CentOS 7添加用户并授权")]),s._v(" "),a("h2",{attrs:{id:"_1-创建新用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-创建新用户","aria-hidden":"true"}},[s._v("#")]),s._v(" 1. 创建新用户")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建用户")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@vultr ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# adduser suiga")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置密码")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@vultr ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# passwd suiga")]),s._v("\nChanging password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user suiga.\nNew password:\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 初始化密码有复杂度判断，如果过于简单，会有提示")]),s._v("\nBAD PASSWORD: The password is shorter than 7 characters\nNew password:\n")])])]),a("h2",{attrs:{id:"_2-授权"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-授权","aria-hidden":"true"}},[s._v("#")]),s._v(" 2. 授权")]),s._v(" "),a("p",[s._v("新创建的用户并不能使用sudo命令，需要给他添加授权。")]),s._v(" "),a("p",[s._v("sudo命令的授权管理是在sudoers文件里的。可以看看sudoers：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@vultr ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sudoers")]),s._v("\n-bash: sudoers: "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("command")]),s._v(" not found\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# whereis 查找位置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@vultr ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# whereis sudoers")]),s._v("\nsudoers: /etc/sudoers /etc/sudoers.d\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -l 查看权限")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@vultr ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls -l /etc/sudoers")]),s._v("\n-r--r----- 1 root root 3938 Apr 10 20:27 /etc/sudoers\n")])])]),a("p",[s._v("只有只读权限，如果想要修改，需要先添加"),a("code",[s._v("w")]),s._v("权限。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@vultr ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod -v u+w /etc/sudoers")]),s._v("\nmode of ‘/etc/sudoers’ changed from 0440 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r--r-----"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to 0640 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw-r-----"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("p",[s._v("然后就可以添加内容了，在下面一行追加新增的用户")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@vultr ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vi /etc/sudoers")]),s._v("\n\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## Allow root to run any commands anywhere")]),s._v("\nroot    ALL"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL\nsuiga   ALL"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ALL"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("       ALL "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个是新增的用户")]),s._v("\n")])])]),a("p",[s._v("保存退出("),a("code",[s._v(":x")]),s._v("/"),a("code",[s._v(":wq")]),s._v(")，记得将之前加的写入权限收回：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@vultr ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod -v u-w /etc/sudoers")]),s._v("\nmode of ‘/etc/sudoers’ changed from 0640 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("rw-r-----"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" to 0440 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r--r-----"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("p",[s._v("切换新用户，使用sudo")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@vultr ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# su suiga")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("suiga@vultr root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/passwd\n\nWe trust you have received the usual lecture from the local System\nAdministrator. It usually boils down to these three things:\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1) Respect the privacy of others.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2) Think before you type.")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3) With great power comes great responsibility.")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("sudo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" suiga:\n")])])]),a("p",[s._v("第一次使用会有提示，且需要输入用户密码，如果想不需要输入密码，可以将之前设置的最后一个"),a("code",[s._v("ALL")]),s._v("改为"),a("code",[s._v("NOPASSWD: ALL")]),s._v("。")]),s._v(" "),a("h1",{attrs:{id:"删除用户密码、禁止登陆"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除用户密码、禁止登陆","aria-hidden":"true"}},[s._v("#")]),s._v(" 删除用户密码、禁止登陆")]),s._v(" "),a("h2",{attrs:{id:"删除密码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除密码","aria-hidden":"true"}},[s._v("#")]),s._v(" 删除密码")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" --delete "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" -d "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("p",[s._v("没有密码就无法登录，对于有些不应该有密码、不允许登录的账户就可以这样来禁止。")]),s._v(" "),a("p",[s._v("还有一种更安全的方式，设置用户为nologin。")]),s._v(" "),a("h2",{attrs:{id:"设置用户为-nologin"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设置用户为-nologin","aria-hidden":"true"}},[s._v("#")]),s._v(" 设置用户为 nologin")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -s /sbin/nologin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),a("p",[s._v("可以结合两种方式来禁止用户的登录。")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("passwd")]),s._v(" -d "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("usermod")]),s._v(" -s /sbin/nologin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("username"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])])])},[],!1,null,null,null);t.default=e.exports}}]);